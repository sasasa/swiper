<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="reset.css"> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.1/css/swiper.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
<section class="sec-hero" id="hero">
  <h1 class="header-logo">
    <a href="#hero" class="js-anchor">
      <img src="./img/header-logo.png" width="132" height="146" alt="みどり">
    </a>
  </h1>
  <div class="swiper-container">
    <ul class="swiper-wrapper">
      <li class="swiper-slide item-01 item">
        <p><img src="./img/hero-slider-01.jpg" width="1440" height="810" alt=""></p>
      </li>
      <li class="swiper-slide item-02 item">
        <p><img src="./img/hero-slider-02.jpg" width="1440" height="810" alt=""></p>
      </li>
      <li class="swiper-slide item-03 item">
        <p><img src="./img/hero-slider-03.jpg" width="1440" height="810" alt=""></p>
      </li>
      <li class="swiper-slide item-04 item">
        <p><img src="./img/hero-slider-04.jpg" width="1440" height="810" alt=""></p>
      </li>          
    </ul>
  </div>
  <div class="hero-catch">
    <p>
      <span class="vertical catch-01">しぜんとワタシ</span>
      <span class="vertical catch-02">ふだんの暮らしに、</span>
      <span class="vertical catch-03">ミドリをひとつ。</span>
    </p>
  </div>
  <p class="hero-date">2019.12.7<span>SAT</span> - 8<span>SUN</span> at コミネゼロ</p>
  <p class="logo-yoga"><a href="./"><img src="./img/yoga.png" width="50" height="50" alt="ヨーガ">ヨーガ</a></p>
</section>
<section class="sec-about" id="about">
  <div class="l-inner inner">
    <div class="theme">
      <div class="about-theme-catch">
        <p>全国からでも有名なヨガの<br>健康と美を彩るワークショップが<br>「ヨーガ」笑顔が集まります</p>
      </div>
      <div class="box-emblem color-01 about-theme-logo">
        <span class="circle circle-01"></span>
        <span class="circle circle-02"></span>
        <p class="emblem-main"><img src="./img/about-logo.png" width="223" height="223" alt="ヨーガ"></p>
      </div>
    </div>
  </div>
</section>
<section>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
</section>
<section>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
  <p>ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ ほげほげ </p>
</section>
<div class="loading">
  <div class="box-loader">
    <span class="dot"><span class="color"></span></span>
    <span class="dot"><span class="color"></span></span>
    <span class="dot"><span class="color"></span></span>
    <span class="dot"><span class="color"></span></span>
    <span class="dot"><span class="color"></span></span>
  </div>
</div>
<script src="loader.js"></script>

<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<!-- https://www.tam-tam.co.jp/tipsnote/html_css/post388.html -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/cssuseragent/2.1.31/cssua.min.js" integrity="sha256-dMYqXxNXfaz/OzoUHWi9t8z42CAhWOfwAaGpMSzuHkc=" crossorigin="anonymous"></script>

<!-- http://higezine.com/blog/javascript/2017/10/28/271/ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.2.0/imagesloaded.pkgd.min.js"></script>

<!-- https://qiita.com/kyota/items/754e0e6cb7a144eda850 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.1.0/velocity.js"></script>

<!-- https://xn--web-oi9du9bc8tgu2a.com/js-swiper-sample/ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.1/js/swiper.min.js"></script>
<script>
function initSwiper() {
  let mySwiper = new Swiper('.swiper-container', {
    loop: true,
    speed: 1600,
    simulateTouch: false,
    effect: 'fade',
    autoplay:{
      delay:2800,
      disableOnInteraction: false
    }
  })
}

$(document).ready(function(){
$('.item').imagesLoaded(function(){

$('.loading .box-loader').delay(200).velocity({
  opacity: 0
},{
  duration: 2800,
  easing: 'easeInOutQuad',
  begin:  function() {
            $('.loading').delay(400).velocity('fadeOut', {
              duration: 2400,
              easing: 'easeInOutQuad',
              begin:function() {
                $('body, html').scrollTop(0);
                initSwiper()
                initAnime();
                $(window).on('scroll', function(){
                  initAnime();
                });
              },
              complete: function() {
                window.cancelAnimationFrame(loading.requestID);
                $('.loading').remove()
              }
          });
  }
})

})
});

$('.js-anchor').click(function(e) {
  e.preventDefault();
  let href = $(this).attr("href")

  $(href).delay(200).velocity("scroll", {
    duration: 600, easing: "easeInOutQuart"
  });
  return false;
});

let lib = [];
function initAnime(){
  let currentPos = $(window).scrollTop();
  let windowHeight = window.innerHeight;
  $('.box-emblem').each(function(){
    let $this = $(this);
    let thisOffsetTop = $this.offset().top;
    if(thisOffsetTop < currentPos + windowHeight - (windowHeight/6)){
      if(!$this.hasClass('animation-done')){
        lib.randomAnimation($this);  
        setTimeout(function(){
          $this.addClass('animation-finished');
        }, 1200);
      }
    }
  })
}


lib.randomAnimation = function(emblem){
  emblem.addClass('animation-done');

  let directionRandomFlag = true;
  if(emblem.hasClass('about-theme-logo')){
    directionRandomFlag = false;
  }

  let circle01 = $('.circle-01', emblem);
  let circle02 = $('.circle-02', emblem);
  let randomFlagA = false;
  let randomFlagB = false;

  let randomNumA = Math.random();
  let randomNumB = Math.random();

  if(randomNumA > 0.5){
    randomFlagA = true;
  }
  if(randomNumB > 0.5){
    randomFlagB = true;
  }

  //mesh circle goes right
  if(!directionRandomFlag) {
    randomFlagA = false;
  }
      
  let X01,
      X02,
      Y01,
      Y02;

  let xLowMidNum = -25,
      xHighMidNum = 25,
      xMaxNum = 53,
      xMinNum = -53,
      yLowMidNum = -5,
      yHighMidNum = 15,
      yMaxNum = 25,
      yMinNum = -25;

  //uppernum of X
  let horizontalA = Math.random() * (xMaxNum - xHighMidNum) + xHighMidNum;

  //lowernum of X
  let horizontalB = Math.random() * (xLowMidNum - xMinNum) + xMinNum;

  //uppernum of Y
  let verticalA = Math.random() * (yMaxNum - yHighMidNum) + yHighMidNum;

  //lowernum of Y
  let verticalB = Math.random() * (yLowMidNum - yMinNum) + yMinNum;

  if(randomFlagA){
    X01 = horizontalA;
    X02 = horizontalB;
  }else{
    X01 = horizontalB;
    X02 = horizontalA;
  }

  if(randomFlagB){
    Y01 = verticalA;
    Y02 = verticalB;
  }else{
    Y01 = verticalB;
    Y02 = verticalA;
  }

  circle01.velocity({
    translateX: X01 + '%',
    translateY: Y01 + '%',
    scale: '1',
    opacity:1
  },{
    duration: 1200,
    easing: 'easeInOutCubic'
  })

  circle02.velocity({
    translateX: X02 + '%',
    translateY: Y02 + '%',
    scale: '1',
    opacity:1
  },{
    duration: 1200,
    easing: 'easeInOutCubic'
  });  
}

</script>
</body>

</html>